<!doctype html>
<html lang="ru">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Org portal</title>
    <script type="importmap">
        {
            "imports": {
                "@libp2p/peer-id-factory": "./this/modules/lib-peerId-factory.js",
                "@newkind/constants": "./this/constants.js",
                "@libp2p/logger": "./this/modules/lib-logger.js",
                "@chainsafe/libp2p-gossipsub": "./this/modules/lib-gossipsub.js",
                "@chainsafe/libp2p-noise": "./this/modules/lib-pubsub.js",
                "@chainsafe/libp2p-yamux": "./this/modules/lib-pubsub.js",
                "@libp2p/circuit-relay-v2": "./this/modules/lib-pubsub.js",
                "@libp2p/identify": "./this/modules/lib-identify.js",
                "@libp2p/dcutr": "./this/modules/lib-pubsub.js",
                "@libp2p/webrtc": "./this/modules/lib-pubsub.js",
                "@libp2p/websockets": "./this/modules/lib-pubsub.js",
                "@libp2p/websockets/filters": "./this/modules/lib-filters.js",
                "@libp2p/kad-dht": "./this/modules/lib-pubsub.js",
                "@multiformats/multiaddr": "./this/modules/lib-pubsub.js",
                "uint8arrays": "./this/modules/lib-pubsub.js",
                "@libp2p/bootstrap": "./this/modules/lib-pubsub.js",
                "datastore-idb": "./this/modules/lib-pubsub.js",
                "@libp2p/ping": "./this/modules/lib-pubsub.js",
                "libp2p": "./this/modules/lib-libp2p.js",
                "@libp2p/peer-store": "./this/modules/lib-peer-store.js",
                "@libp2p/peer-id": "./this/modules/lib-pubsub.js",
                "@libp2p/pubsub-peer-discovery": "./this/modules/lib-pubsubPeerDiscovery.js",
                "@libp2p/interface-transport": "./this/modules/lib-pubsub.js",
                "cborg": "./this/modules/lib-cbor.js",
                "it-length-prefixed-stream": "./this/modules/lib-stream.js"
            }
        }
    </script>
</head>
<body>
<button
        onclick="(function(self) {
                window.location.href = `${window.location.origin}${window.location.pathname}`
            })(this)"
>
    empty
</button>

<button
        onclick="(function(self) {
                window.location.href = `${window.location.origin}${window.location.pathname}?nkWorld&bootstrap&pubsubPeerDiscovery`
            })(this)"
>
    World
</button>

<nk-radio
        id="nk-radio_0"
        slot="nk-radio_0"
>
    <template>
        <div class="audio-newkind">
            <form class="audio-newkind__form">
                <input type="radio" class="audio-newkind__radio" id="raxxla" name="radio-selection"
                       value="https://hermitage.hostingradio.ru/hermitage128.mp3" checked>
                <label for="raxxla"><span></span>Raxxla Radio</label>
                <input type="radio" class="audio-newkind__radio" id="earth" name="radio-selection"
                       value="https://ice1.somafm.com/u80s-128-aac">
                <label for="earth"><span></span>Earth Radio</label>
                <input type="radio" class="audio-newkind__radio" id="cats-radio" name="radio-selection"
                       value="https://ice1.somafm.com/deepspaceone-128-aac">
                <label for="cats-radio"><span></span>Cats Radio</label>
            </form>
            <canvas class="audio-newkind__canvas" id="gfx" oncontextmenu="event.preventDefault()"
                    style="cursor: default;"></canvas>
            <button class="audio-newkind__btn" id="start">Start Audio</button>
            <div class="audio-newkind__error" id="error">[ Your browser does not support WebGPU or it is not enabled ]
            </div>
        </div>
    </template>
</nk-radio>

<nk-elite
        id="nk-elite_0"
        slot="nk-elite_0"
>
    <template>
        <div class="game-newkind">
            <form class="game-newkind__form">
                <span><input type="checkbox" id="showGameConsole" checked>Show console</span>
                <span><input type="checkbox" id="showScreenName">Show greetings</span>
                <span><input type="checkbox" id="showChart1" checked>Show Galactic Chart</span>
                <span><input type="checkbox" id="showChart2" checked>Show Short Range Chart</span>
            </form>
            <button class="game-newkind__btn" id="showAndApply">Apply and Show</button>
            <canvas class="game-newkind__canvas" id="nk-elitecanvas" oncontextmenu="event.preventDefault()"></canvas>
        </div>
    </template>
</nk-elite>

<nk-world id="nk-world_0">
    <template>
        <div class="container">
            <div class="item">
                <slot name="nk-universe_0"></slot>
            </div>
            <div class="item">
                <div class="container-menu">
                    <div class="menu">
                        <slot name="nk-menu_0"></slot>
                    </div>
<!--                    <div class="chat">-->
<!--                        <slot name="nk-chat_0"></slot>-->
<!--                    </div>-->
                </div>
            </div>
            <div class="item">
                <slot name="nk-p2p_0"></slot>
            </div>
        </div>

        <nk-universe
                id="nk-universe_0"
                slot="nk-universe_0"
        >
            <template>
                <div class="universe">
                    <slot name="nk-menu_0"></slot>
                    <slot name="nk-elite-control"></slot>
                </div>
                <nk-elite-control
                    id="nk-elite-control_0"
                    slot="nk-elite-control"
                >
                    <template>
                        <div class="control">
                            <div class="control_left">
                                <div class="control_left_top">
                                    <div class="item">
                                        <div class="text">FS</div>
                                        <progress class="progress" max="100" value="70">70%</progress>
                                    </div>
                                    <div class="item">
                                        <div class="text">AS</div>
                                        <progress class="progress" max="100" value="70">70%</progress>
                                    </div>
                                </div>
                                <hr>
                                <div class="control_left_center">
                                    <div class="item">
                                        <div class="text">FU</div>
                                        <progress class="progress" max="100" value="70">70%</progress>
                                    </div>
                                    <div class="item">
                                        <div class="text">CT</div>
                                        <progress class="progress" max="100" value="70">70%</progress>
                                    </div>
                                    <div class="item">
                                        <div class="text">LT</div>
                                        <progress class="progress" max="100" value="70">70%</progress>
                                    </div>
                                    <div class="item">
                                        <div class="text">AL</div>
                                        <progress class="progress" max="100" value="70">70%</progress>
                                    </div>
                                </div>
                                <hr>
                                <div class="control_left_down">
                                    <div class="item">
                                        <div class="text img">
                                            <img class="image_rocket"
                                                 src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAGCAYAAADdXo4uAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAArElEQVQokZWRMQrCQBRE35q19gB2nsDeW4hg6zG8gGfwFIbgCSzEysLCSlJICCKmUhFhN+RbWJjdJGBeNwN/ZuCrOELMCwCMheEMhccpRPK37zaz3sJ86eboewLnzVfYov4wO8L18H9Rdql6KpwgUiqwBSA/HWgIFEjDiDp6A+iPXE/7Ad2OdyUgQiueCcQ3r6gs8gKmUfVHqzGtqvYpLHZujrO/7fImHqbqfQAfpDbMQIr8MAAAAABJRU5ErkJggg=="/>
                                        </div>
                                        <div class="rockets">
                                            <div class="rocket"></div>
                                            <div class="rocket"></div>
                                            <div class="rocket"></div>
                                            <div class="rocket"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="control_center">
                                <div class="radar top">
                                    <div class="center_left_45"></div>
                                    <div class="center_right_45"></div>
                                    <div class="center_x_top_4"></div>
                                    <div class="center_x_top_3"></div>
                                    <div class="center_x_top_2"></div>
                                    <div class="center_x_top_1"></div>
                                    <div class="center_x"></div>
                                    <div class="center_x_bottom_1"></div>
                                    <div class="center_x_bottom_2"></div>
                                    <div class="center_x_bottom_3"></div>
                                    <div class="center_y_left_3"></div>
                                    <div class="center_y_left_2"></div>
                                    <div class="center_y_left_1"></div>
                                    <div class="center_y"></div>
                                    <div class="center_y_right_1"></div>
                                    <div class="center_y_right_2"></div>
                                    <div class="center_y_right_3"></div>
                                </div>
                                <div class="border radar">

                                </div>
                            </div>
                            <div class="control_right">
                                <div class="control_right_top">
                                    <div class="item">
                                        <progress class="progress" max="100" value="70">70%</progress>
                                        <div class="text">SP</div>
                                    </div>

                                    <div class="item">
                                        <!--							<progress class="progress" max="100" value="70">70%</progress>-->
                                        <label class="item slider" style="--c: #BD1550">
                                            <input class="input-slider" type="range" id="two" min="-50" max="50" step="1" value="0">
                                            <output class="bottom" for="two" style="--min: -50;--max: 50"></output>
                                        </label>
                                        <div class="text">RL</div>
                                    </div>
                                    <div class="item">
                                        <label class="item slider" style="--c: #BD1550">
                                            <input class="input-slider" type="range" id="three" min="-50" max="50" step="1"
                                                   value="0">
                                            <output class="bottom" for="three" style="--min: -50;--max: 50"></output>
                                        </label>
                                        <!--							<progress class="progress" max="100" value="70">70%</progress>-->
                                        <div class="text">DC</div>
                                    </div>
                                </div>
                                <hr>
                                <div class="control_right_down">
                                    <div class="item">
                                        <progress class="progress_laser" max="100" value="70">70%</progress>
                                        <div class="text">1</div>
                                    </div>
                                    <hr>
                                    <div class="item">
                                        <progress class="progress_laser" max="100" value="70">70%</progress>
                                        <div class="text">2</div>
                                    </div>
                                    <hr>
                                    <div class="item">
                                        <progress class="progress_laser" max="100" value="70">70%</progress>
                                        <div class="text">3</div>
                                    </div>
                                    <hr>
                                    <div class="item">
                                        <progress class="progress_laser" max="100" value="70">70%</progress>
                                        <div class="text">4</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </template>
                </nk-elite-control>

                <nk-menu
                        id="nk-menu_0"
                        slot="nk-menu_0"
                >
                    <template>
                        <div class="container">
                            <div class="system-modal">
                                <slot name="system-modal"></slot>
                            </div>
                            <div class="solar-system">
                                <slot name="solar-system"></slot>
                            </div>
                            <div class="container-info">
                                <div class="container-left">
                                    <div class="peerInfo">
                                        <div class="help-section">
                                            <slot name="help-section"></slot>
                                        </div>
                                        <div class="item planet">
                                            <p>Планета</p>
                                            <span class="planet-text"></span>
                                        </div>
                                        <div class="item peerId">
                                            <p>ID Планета</p>
                                            <span class="planet-public-id self_peerId_p"></span>
                                        </div>
                                        <div class="item self">
                                            <p>Приватный ID</p>
                                            <span class="planet-private-id self_p"></span>
                                        </div>
                                        <div class="item ma">
                                            <p>Открытый Канал</p>
                                            <ul class="ma_public"></ul>
                                        </div>
                                        <div class="item private_ma">
                                            <p>Закрытый Канал</p>
                                            <ul class="ma_private"></ul>
                                        </div>
                                        <div class="webrtc-direct">
                                            <h2> Собственные корабли</h2>
                                            <ul class="group-ships">
                                                <li class="group-ships-item">
                                                    <div class="command-group">
                                                        <div class="command-group-title">
                                                            <p>M-1</p>
                                                            <span class="ship-id-1_private"></span>
                                                        </div>
                                                        <select class="command-group-select">
                                                            <option value="">Выберите действие</option>
                                                            <option value="Патрулировать">Патрулировать</option>
                                                            <option value="Следовать">Следовать</option>
                                                            <option value="Следить">Следить</option>
                                                            <option value="Сгруппироваться">Сгруппироваться</option>
                                                            <option value="Торговать">Торговать</option>
                                                        </select>
                                                    </div>
                                                    <div class="item">
                                                        <span class="ship-1-name"></span>
                                                        <div class="ship-id">
                                                            <span class="ship-id-1_public"></span>
                                                        </div>
                                                    </div>
                                                </li>
                                                <li class="group-ships-item">
                                                    <div class="command-group">
                                                        <div class="command-group-title">
                                                            <p>M-2</p>
                                                            <span class="ship-id-2_private"></span>
                                                        </div>
                                                        <select class="command-group-select">
                                                            <option value="">Выберите действие</option>
                                                            <option value="Патрулировать">Патрулировать</option>
                                                            <option value="Следовать">Следовать</option>
                                                            <option value="Следить">Следить</option>
                                                            <option value="Сгруппироваться">Сгруппироваться</option>
                                                            <option value="Торговать">Торговать</option>
                                                        </select>
                                                    </div>
                                                    <div class="item">
                                                        <span class="ship-2-name"></span>
                                                        <div class="ship-id">
                                                            <span class="ship-id-2_public"></span>
                                                        </div>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>

                                        <div class="own-stations">
                                            <h2> Собственные станции</h2>
                                            <ul class="group-ships">
                                                <li class="group-ships-item">
                                                    <div class="command-group">
                                                        <div class="command-group-title">
                                                            <p>Торговые станции</p>
                                                            <span class="ship-id-1_private"></span>
                                                        </div>
                                                        <select class="command-group-select">
                                                            <option value="">Выберите действие</option>
                                                            <option value="Патрулировать">Прекратить торговлю</option>
                                                            <option value="Следовать">Начать торговлю</option>
                                                            <option value="Следить">Запретить посадку</option>
                                                            <option value="Сгруппироваться">Разрешить посадку</option>
                                                            <option value="Торговать">Согласовать цены</option>
                                                        </select>
                                                    </div>
                                                    <div class="item">
                                                        <span class="ship-1-name"></span>
                                                        <div class="ship-id">
                                                            <span class="ship-id-1_public"></span>
                                                        </div>
                                                    </div>
                                                </li>
                                                <li class="group-ships-item">
                                                    <div class="command-group">
                                                        <div class="command-group-title">
                                                            <p>Добывающие станции</p>
                                                            <span class="ship-id-2_private"></span>
                                                        </div>
                                                        <select class="command-group-select">
                                                            <option value="">Выберите действие</option>
                                                            <option value="Патрулировать">Прекратить торговлю</option>
                                                            <option value="Следовать">Начать торговлю</option>
                                                            <option value="Следить">Запретить посадку</option>
                                                            <option value="Сгруппироваться">Разрешить посадку</option>
                                                            <option value="Торговать">Согласовать цены</option>
                                                        </select>
                                                    </div>
                                                    <div class="item">
                                                        <span class="ship-2-name"></span>
                                                        <div class="ship-id">
                                                            <span class="ship-id-2_public"></span>
                                                        </div>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="private-self-discovery invisible">
                                        <div class="private-self title">
                                            <h2>Приватный собственный канал</h2>
                                            <button class="refresh">0</button>
                                        </div>
                                        <ul></ul>
                                    </div>
                                    <div class="discovery invisible">
                                        <div class="title">
                                            <h2>Канал связи</h2>
                                            <button class="refresh">0</button>
                                        </div>
                                        <ul></ul>
                                    </div>
                                </div>
                                <div class="container-right">
                                    <div class="security">
                                        <h2>Безопасность</h2>
                                        <div class="security-container">
                                            <div class="wrapper">
                                                <label for="security-key"> Ключ доступа </label>
                                                <input id="security-key" type="file">
                                            </div>
                                            <div class="state">
                                                <div>Состояние</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chat">
                                        <slot name="nk-chat_0"></slot>
                                    </div>
                                    <div class="pubsub">
                                        <div class="title">
                                            <h2>Канал связи</h2>
                                            <button class="refresh">0</button>
                                        </div>
                                        <ul class="public-list"></ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <nk-chat
                                id="nk-chat_0"
                                slot="nk-chat_0"
                        >
                            <template>
                                <div class="chat">
                                    <div class="header">
                                        <select class="list-peer">
                                            <option value="">Выберите пользователя</option>
                                        </select>
                                        <button class="refresh">O</button>
                                    </div>
                                    <div class="chat-container">
                                        <textarea class="input" placeholder="Входящее сообщение"></textarea>
                                        <textarea class="output" placeholder="введите сообщение"></textarea>
                                    </div>
                                    <div class="footer">
                                        <button class="send disabled">Отправить</button>
                                    </div>
                                </div>
                            </template>
                        </nk-chat>
                    </template>
                </nk-menu>
            </template>
        </nk-universe>
    </template>
</nk-world>
<nk-p2p
        id="nk-p2p_0"
        slot="nk-p2p_0"
        data-type="public"
        data-planet="earth"
>
    <template>
        <button
                onclick="(function(self) {
                            const container = self.getRootNode().querySelector('.libp2p')
                            container.classList.toggle('enabled')
                        })(this)"
        >
            Node
        </button>
        <div class="libp2p">
            <div class="control-params">
                <button
                        onclick="(function(self) {
                window.location.href = `${window.location.origin}${window.location.pathname}`
            })(this)"
                >
                    empty
                </button>
                <button
                        onclick="(function(self) {
                window.location.href = `${window.location.origin}${window.location.pathname}?bootstrap`
            })(this)"
                >
                    Bootstrap
                </button>

                <button
                        onclick="(function(self) {
                window.location.href = `${window.location.origin}${window.location.pathname}?bootstrap&dht`
            })(this)"
                >
                    Bootstrap && DHT
                </button>

                <button
                        onclick="(function(self) {
                window.location.href = `${window.location.origin}${window.location.pathname}?bootstrap&pubsubPeerDiscovery`
            })(this)"
                >
                    Bootstrap && pubsubPeerDiscovery
                </button>
            </div>
            <div>
                <label for="dial-multiaddr-input">Dial MultiAddr</label>
                <input type="text" id="dial-multiaddr-input" placeholder="/ip4/127.0.0.1/tcp/1234/ws/p2p/123Foo"/>
                <div class="multiaddr-input-button">
                    <button id="dial-multiaddr-button">Connect</button>
                    <button id="clear-button">Clear</button>
                </div>

                <h4>PeerId</h4>
                <p id="peer-id"></p>

                <h4>DHT mode</h4>
                <p id="dht-mode"></p>

                <h4>Listening Addresses</h4>
                <ul id="listening-addresses">
                    <li>None</li>
                </ul>

                <h4>Connected Peers</h4>
                <ul id="peer-connections">
                    <li>None</li>
                </ul>
            </div>
            <hr/>
            <div>
                <h2>PubSub</h2>
                <label for="subscribe-topic-input">Subscribe to topic</label>
                <input type="text" id="subscribe-topic-input" placeholder="my-topic"/>
                <button id="subscribe-topic-button">Subscribe</button>

                <h4>Topic Peers</h4>
                <ul id="topic-peers">
                    <li>None</li>
                </ul>

                <label for="send-topic-message-input">Send Message to Topic</label>
                <input type="text" id="send-topic-message-input" placeholder="hello world" disabled="disabled"/>
                <button id="send-topic-message-button" disabled="disabled">Send</button>
            </div>
            <hr/>
            <div class="output">
                <h2>Output</h2>
                <pre id="output"></pre>
            </div>
        </div>
    </template>
</nk-p2p>
<nk-p2p
        id="nk-p2p_1"
        slot="nk-p2p_0"
        data-type="private"
>
    <template>
        <button
                onclick="(function(self) {
                            const container = self.getRootNode().querySelector('.libp2p')
                            container.classList.toggle('enabled')
                        })(this)"
        >
            Node
        </button>
        <div class="libp2p">
            <div class="control-params">
                <button
                        onclick="(function(self) {
                window.location.href = `${window.location.origin}${window.location.pathname}`
            })(this)"
                >
                    empty
                </button>
                <button
                        onclick="(function(self) {
                window.location.href = `${window.location.origin}${window.location.pathname}?bootstrap`
            })(this)"
                >
                    Bootstrap
                </button>

                <button
                        onclick="(function(self) {
                window.location.href = `${window.location.origin}${window.location.pathname}?bootstrap&dht`
            })(this)"
                >
                    Bootstrap && DHT
                </button>

                <button
                        onclick="(function(self) {
                window.location.href = `${window.location.origin}${window.location.pathname}?bootstrap&pubsubPeerDiscovery`
            })(this)"
                >
                    Bootstrap && pubsubPeerDiscovery
                </button>
            </div>
            <div>
                <label for="dial-multiaddr-input">Dial MultiAddr</label>
                <input type="text" id="dial-multiaddr-input" placeholder="/ip4/127.0.0.1/tcp/1234/ws/p2p/123Foo"/>
                <div class="multiaddr-input-button">
                    <button id="dial-multiaddr-button">Connect</button>
                    <button id="clear-button">Clear</button>
                </div>

                <h4>PeerId</h4>
                <p id="peer-id"></p>

                <h4>DHT mode</h4>
                <p id="dht-mode"></p>

                <h4>Listening Addresses</h4>
                <ul id="listening-addresses">
                    <li>None</li>
                </ul>

                <h4>Connected Peers</h4>
                <ul id="peer-connections">
                    <li>None</li>
                </ul>
            </div>
            <hr/>
            <div>
                <h2>PubSub</h2>
                <label for="subscribe-topic-input">Subscribe to topic</label>
                <input type="text" id="subscribe-topic-input" placeholder="my-topic"/>
                <button id="subscribe-topic-button">Subscribe</button>

                <h4>Topic Peers</h4>
                <ul id="topic-peers">
                    <li>None</li>
                </ul>

                <label for="send-topic-message-input">Send Message to Topic</label>
                <input type="text" id="send-topic-message-input" placeholder="hello world" disabled="disabled"/>
                <button id="send-topic-message-button" disabled="disabled">Send</button>
            </div>
            <hr/>
            <div class="output">
                <h2>Output</h2>
                <pre id="output"></pre>
            </div>
        </div>
    </template>
</nk-p2p>
</body>
<script type="module">
    import {init} from './this/index.mjs'

    init({
        components: ['nk-elite-control','nk-world','nk-menu', 'nk-elite', 'nk-radio', 'nk-p2p', 'nk-universe', 'nk-chat']
    }).then().catch( error => console.log( error ) );

//        globalThis["LFreeQueue"].Store( "Key1", 10 );
//        let key = globalThis["LFreeQueue"].Load( "Key1" );
//        console.log( "Key1: value=" + key + "\n" );

</script>
</html>